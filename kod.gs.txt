function onOpen() {
  const ui = SpreadsheetApp.getUi();
  const menu = ui.createMenu('AutoFill');
  menu.addItem('Create New Docs_UA', 'createNewGoogleDocs_UA')
  menu.addItem('Create New Docs_PL', 'createNewGoogleDocs_PL')
  menu.addItem('Create New Docs_dorosly', 'createNewGoogleDocs_dorosly')
  menu.addToUi();
}

function createNewGoogleDocs_UA() {
  //This value should be the id of your document template that we created in the last step
  const googleDocTemplate = DriveApp.getFileById('link-do-templatki');
  
  //This value should be the id of the folder where you want your completed documents stored
  const destinationFolder = DriveApp.getFolderById('link-do-folderu')
  //Here we store the sheet as a variable
  const sheet = SpreadsheetApp
    .getActiveSpreadsheet()
    .getSheetByName('UA')
  
  //Now we get all of the values as a 2D array
  const rows = sheet.getDataRange().getValues();
  
  //Start processing each spreadsheet row
  rows.forEach(function(row, index){
    //Here we check if this row is the headers, if so we skip it
    if (index === 0) return;
    //Here we check if a document has already been generated by looking at 'Document Link', if so we skip it
    if (row[2]) return;
    //Using the row data in a template literal, we make a copy of our template document in our destinationFolder
    const copy = googleDocTemplate.makeCopy(`${row[4]}, ${row[3]} Umowa` , destinationFolder)
    //Once we have the copy, we then open it using the DocumentApp
    const doc = DocumentApp.openById(copy.getId())
    //All of the content lives in the body, so we get that for editing
    const body = doc.getBody();
    //In this line we do some friendly date formatting, that may or may not work for you locale
    const friendlyDate = new Date(row[5]).toLocaleDateString();
    
    //In these lines, we replace our replacement tokens with values from our spreadsheet row
    body.replaceText('{{id}}', row[1]);
    body.replaceText('{{first}}', row[3]);
    body.replaceText('{{last}}', row[4]);
    body.replaceText('{{date}}', friendlyDate);
    body.replaceText('{{gender}}', row[6]);
    body.replaceText('{{pesel}}', row[7]);
    body.replaceText('{{region}}', row[16]);
    body.replaceText('{{refugee}}', row[15]);
    body.replaceText('{{d}}', row[17]);
    body.replaceText('{{art}}', row[36]);
    body.replaceText('{{school}}', row[10]);
    body.replaceText('{{tryb}}', row[9]);
    body.replaceText('{{np}}', row[20]);
    body.replaceText('{{przyczyna_np}}', row[21]);
    body.replaceText('{{pz}}', row[22]);
    body.replaceText('{{jakie_pz}}', row[23]);
    body.replaceText('{{tz}}', row[26]);
    body.replaceText('{{jakie_tz}}', row[27]);
    body.replaceText('{{iz}}', row[34]);
    body.replaceText('{{jakie_iz}}', row[35]);
    body.replaceText('{{op_first}}', row[11]);
    body.replaceText('{{op_last}}', row[12]);
    body.replaceText('{{op_adress}}', row[8]);
    body.replaceText('{{op_pesel}}', row[13]);
    body.replaceText('{{op_phone}}', row[18]);
    body.replaceText('{{op_mail}}', row[19]);
    body.replaceText('{{agree}}', row[37]);
    body.replaceText('{{op2_first}}', row[38]);
    body.replaceText('{{op2_last}}', row[39]);
    body.replaceText('{{op2_phone}}', row[40]);
    body.replaceText('{{op2_pesel}}', row[41]);
    body.replaceText('{{op3_first}}', row[43]);
    body.replaceText('{{op3_last}}', row[44]);
    body.replaceText('{{op3_phone}}', row[45]);
    body.replaceText('{{op3_pesel}}', row[46]);
    body.replaceText('{{op4_first}}', row[48]);
    body.replaceText('{{op4_last}}', row[49]);
    body.replaceText('{{op4_phone}}', row[50]);
    body.replaceText('{{op4_pesel}}', row[51]);

    
    //We make our changes permanent by saving and closing the document
    doc.saveAndClose();
    //Store the url of our new document in a variable
    const url = doc.getUrl();
    //Write that value back to the 'Document Link' column in the spreadsheet. 
    sheet.getRange(index + 1, 3).setValue(url)
    
  })
  
}


  //-----
function createNewGoogleDocs_PL() {
  //This value should be the id of your document template that we created in the last step
  const googleDocTemplate = DriveApp.getFileById('link-do-templatki');
  
  //This value should be the id of the folder where you want your completed documents stored
  const destinationFolder = DriveApp.getFolderById('link-do-folderu')
  //Here we store the sheet as a variable
  const sheet = SpreadsheetApp
    .getActiveSpreadsheet()
    .getSheetByName('PL')
  
  //Now we get all of the values as a 2D array
  const rows = sheet.getDataRange().getValues();
  
  //Start processing each spreadsheet row
  rows.forEach(function(row, index){
    //Here we check if this row is the headers, if so we skip it
    if (index === 0) return;
    //Here we check if a document has already been generated by looking at 'Document Link', if so we skip it
    if (row[2]) return;
    //Using the row data in a template literal, we make a copy of our template document in our destinationFolder
    const copy = googleDocTemplate.makeCopy(`${row[4]}, ${row[3]} Umowa` , destinationFolder)
    //Once we have the copy, we then open it using the DocumentApp
    const doc = DocumentApp.openById(copy.getId())
    //All of the content lives in the body, so we get that for editing
    const body = doc.getBody();
    //In this line we do some friendly date formatting, that may or may not work for you locale
    const friendlyDate = new Date(row[5]).toLocaleDateString();
    
    //In these lines, we replace our replacement tokens with values from our spreadsheet row
    body.replaceText('{{id}}', row[1]);
    body.replaceText('{{first}}', row[3]);
    body.replaceText('{{last}}', row[4]);
    body.replaceText('{{date}}', friendlyDate);
    body.replaceText('{{gender}}', row[7]);
    body.replaceText('{{pesel}}', row[6]);
    body.replaceText('{{region}}', row[8]);
    body.replaceText('{{refugee}}', row[9]);
    body.replaceText('{{d}}', row[16]);
    body.replaceText('{{school}}', row[10]);
    body.replaceText('{{tryb}}', row[9]);
    body.replaceText('{{art}}', row[37]);
    body.replaceText('{{np}}', row[19]);
    body.replaceText('{{przyczyna_np}}', row[20]);
    body.replaceText('{{pz}}', row[21]);
    body.replaceText('{{jakie_pz}}', row[22]);
    body.replaceText('{{tz}}', row[25]);
    body.replaceText('{{jakie_tz}}', row[26]);
    body.replaceText('{{iz}}', row[35]);
    body.replaceText('{{jakie_iz}}', row[36]);
    body.replaceText('{{op_first}}', row[11]);
    body.replaceText('{{op_last}}', row[12]);
    body.replaceText('{{op_adress}}', row[14]);
    body.replaceText('{{op_pesel}}', row[13]);
    body.replaceText('{{op_phone}}', row[17]);
    body.replaceText('{{op_mail}}', row[18]);
    body.replaceText('{{agree}}', row[38]);
    body.replaceText('{{op2_first}}', row[39]);
    body.replaceText('{{op2_last}}', row[40]);
    body.replaceText('{{op2_phone}}', row[41]);
    body.replaceText('{{op2_pesel}}', row[42]);
    body.replaceText('{{op3_first}}', row[44]);
    body.replaceText('{{op3_last}}', row[45]);
    body.replaceText('{{op3_phone}}', row[46]);
    body.replaceText('{{op3_pesel}}', row[47]);
    body.replaceText('{{op4_first}}', row[49]);
    body.replaceText('{{op4_last}}', row[50]);
    body.replaceText('{{op4_phone}}', row[51]);
    body.replaceText('{{op4_pesel}}', row[52]);

    
    //We make our changes permanent by saving and closing the document
    doc.saveAndClose();
    //Store the url of our new document in a variable
    const url = doc.getUrl();
    //Write that value back to the 'Document Link' column in the spreadsheet. 
    sheet.getRange(index + 1, 3).setValue(url)
    
  })
  
}



  function createNewGoogleDocs_dorosly() {
  //This value should be the id of your document template that we created in the last step
  const googleDocTemplate = DriveApp.getFileById('link-do-templatki');
  
  //This value should be the id of the folder where you want your completed documents stored
  const destinationFolder = DriveApp.getFolderById('link-do-folderu')
  //Here we store the sheet as a variable
  const sheet = SpreadsheetApp
    .getActiveSpreadsheet()
    .getSheetByName('Dorosli')
  
  //Now we get all of the values as a 2D array
  const rows = sheet.getDataRange().getValues();
  
  //Start processing each spreadsheet row
  rows.forEach(function(row, index){
    //Here we check if this row is the headers, if so we skip it
    if (index === 0) return;
    //Here we check if a document has already been generated by looking at 'Document Link', if so we skip it
    if (row[2]) return;
    //Using the row data in a template literal, we make a copy of our template document in our destinationFolder
    const copy = googleDocTemplate.makeCopy(`${row[4]}, ${row[3]} Umowa` , destinationFolder)
    //Once we have the copy, we then open it using the DocumentApp
    const doc = DocumentApp.openById(copy.getId())
    //All of the content lives in the body, so we get that for editing
    const body = doc.getBody();
    //In this line we do some friendly date formatting, that may or may not work for you locale
    const friendlyDate = new Date(row[5]).toLocaleDateString();
    
    //In these lines, we replace our replacement tokens with values from our spreadsheet row
    body.replaceText('{{id}}', row[1]);
    body.replaceText('{{first}}', row[3]);
    body.replaceText('{{last}}', row[4]);
    body.replaceText('{{date}}', friendlyDate);
    body.replaceText('{{gender}}', row[7]);
    body.replaceText('{{pesel}}', row[6]);
    body.replaceText('{{region}}', row[11]);
    body.replaceText('{{refugee}}', row[10]);
    body.replaceText('{{d}}', row[12]);
    body.replaceText('{{mail}}', row[14]);
    body.replaceText('{{phone}}', row[13]);
    //body.replaceText('{{school}}', row[10]);
    //body.replaceText('{{tryb}}', row[9]);
    //body.replaceText('{{art}}', row[37]);
    body.replaceText('{{np}}', row[15]);
    body.replaceText('{{przyczyna_np}}', row[16]);
    body.replaceText('{{pz}}', row[17]);
    body.replaceText('{{jakie_pz}}', row[18]);
    //body.replaceText('{{tz}}', row[25]);
    //body.replaceText('{{jakie_tz}}', row[26]);
    body.replaceText('{{iz}}', row[27]);
    body.replaceText('{{jakie_iz}}', row[28]);
    //body.replaceText('{{op_first}}', row[11]);
    //body.replaceText('{{op_last}}', row[12]);
    //body.replaceText('{{op_adress}}', row[14]);
    //body.replaceText('{{op_pesel}}', row[13]);
    //body.replaceText('{{op_phone}}', row[17]);
    //body.replaceText('{{op_mail}}', row[18]);
    //body.replaceText('{{agree}}', row[38]);
    //body.replaceText('{{op2_first}}', row[39]);
    //body.replaceText('{{op2_last}}', row[40]);
    //body.replaceText('{{op2_phone}}', row[41]);
    //body.replaceText('{{op2_pesel}}', row[42]);
    //body.replaceText('{{op3_first}}', row[44]);
    //body.replaceText('{{op3_last}}', row[45]);
    //body.replaceText('{{op3_phone}}', row[46]);
    //body.replaceText('{{op3_pesel}}', row[47]);
    //body.replaceText('{{op4_first}}', row[49]);
    //body.replaceText('{{op4_last}}', row[50]);
    //body.replaceText('{{op4_phone}}', row[51]);
    //body.replaceText('{{op4_pesel}}', row[52]);
    body.replaceText('{{leki}}', row[21]);
    body.replaceText('{{jakie_leki}}', row[22]);
    body.replaceText('{{dawki}}', row[23]);
    body.replaceText('{{ap}}', row[24]);
    body.replaceText('{{oc}}', row[25]);
    body.replaceText('{{so}}', row[26]);
    body.replaceText('{{zz}}', row[19]);
    body.replaceText('{{jakie_zz}}', row[20]);
    
    //We make our changes permanent by saving and closing the document
    doc.saveAndClose();
    //Store the url of our new document in a variable
    const url = doc.getUrl();
    //Write that value back to the 'Document Link' column in the spreadsheet. 
    sheet.getRange(index + 1, 3).setValue(url)
    
  })
  
}
